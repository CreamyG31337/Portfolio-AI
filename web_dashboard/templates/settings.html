{% extends "base.html" %}

{% block title %}User Preferences - Portfolio Dashboard{% endblock %}

{% block page_title %}üë§ User Preferences{% endblock %}
{% block page_subtitle %}Configure your dashboard settings{% endblock %}

{% block extra_head %}
{% endblock %}

{% block content %}
<div class="max-w-4xl mx-auto">
    <!-- Timezone Settings -->
    <div
        class="bg-dashboard-surface rounded-lg shadow-lg p-6 mb-6 hover:-translate-y-0.5 transition-transform duration-200">
        <h2 class="text-2xl font-bold text-text-primary mb-4">üåç Timezone</h2>
        <p class="text-text-secondary mb-4">Select your timezone. All times in the dashboard will be displayed in this
            timezone.</p>

        <div class="mb-4">
            <label for="timezone-select" class="block text-sm font-medium text-text-secondary mb-2">Select your
                timezone:</label>
            <select id="timezone-select" class="bg-dashboard-surface-alt border border-border text-text-primary text-sm rounded-lg focus:ring-accent focus:border-accent block w-full p-2.5">
                <option value="America/Los_Angeles">America/Los_Angeles - Pacific Time (US & Canada)</option>
                <option value="America/Denver">America/Denver - Mountain Time (US & Canada)</option>
                <option value="America/Chicago">America/Chicago - Central Time (US & Canada)</option>
                <option value="America/New_York">America/New_York - Eastern Time (US & Canada)</option>
                <option value="America/Toronto">America/Toronto - Eastern Time (Canada)</option>
                <option value="America/Vancouver">America/Vancouver - Pacific Time (Canada)</option>
                <option value="UTC">UTC - UTC (Coordinated Universal Time)</option>
                <option value="Europe/London">Europe/London - London (GMT/BST)</option>
                <option value="Europe/Paris">Europe/Paris - Paris (CET/CEST)</option>
                <option value="Asia/Tokyo">Asia/Tokyo - Tokyo (JST)</option>
                <option value="Australia/Sydney">Australia/Sydney - Sydney (AEDT/AEST)</option>
            </select>
        </div>

        <div id="timezone-preview" class="text-sm text-text-tertiary mb-4"></div>

        <div id="timezone-success"
            class="hidden bg-theme-success-bg text-theme-success-text border border-theme-success-text rounded-lg px-4 py-3 mt-2">
            ‚úÖ Timezone saved successfully!</div>
        <div id="timezone-error"
            class="hidden bg-theme-error-bg text-theme-error-text border border-theme-error-text rounded-lg px-4 py-3 mt-2">
            ‚ùå Failed to save timezone. Please try again.</div>
    </div>

    <!-- Currency Settings -->
    <div
        class="bg-dashboard-surface rounded-lg shadow-lg p-6 mb-6 hover:-translate-y-0.5 transition-transform duration-200">
        <h2 class="text-2xl font-bold text-text-primary mb-4">üí∞ Currency</h2>
        <p class="text-text-secondary mb-4">Select your preferred display currency. All values will be converted and
            displayed in this currency.</p>

        <div class="mb-4">
            <label for="currency-select" class="block text-sm font-medium text-text-secondary mb-2">Select your display
                currency:</label>
            <select id="currency-select" class="bg-dashboard-surface-alt border border-border text-text-primary text-sm rounded-lg focus:ring-accent focus:border-accent block w-full p-2.5">
                <option value="CAD">CAD - Canadian Dollar</option>
                <option value="USD">USD - US Dollar</option>
            </select>
        </div>

        <div id="currency-success"
            class="hidden bg-theme-success-bg text-theme-success-text border border-theme-success-text rounded-lg px-4 py-3 mt-2">
            ‚úÖ Currency saved successfully!</div>
        <div id="currency-error"
            class="hidden bg-theme-error-bg text-theme-error-text border border-theme-error-text rounded-lg px-4 py-3 mt-2">
            ‚ùå Failed to save currency. Please try again.</div>
    </div>

    <!-- Theme Settings -->
    <div
        class="bg-dashboard-surface rounded-lg shadow-lg p-6 mb-6 hover:-translate-y-0.5 transition-transform duration-200">
        <h2 class="text-2xl font-bold text-text-primary mb-4">üé® Theme</h2>
        <p class="text-text-secondary mb-4">Override your browser/system theme preference. 'System Default' follows your
            OS setting.</p>

        <div class="mb-4">
            <label for="theme-select" class="block text-sm font-medium text-text-secondary mb-2">Select your
                theme:</label>
            <select id="theme-select" class="bg-dashboard-surface-alt border border-border text-text-primary text-sm rounded-lg focus:ring-accent focus:border-accent block w-full p-2.5">
                <option value="system" {% if current_theme=='system' %}selected{% endif %}>System Default</option>
                <option value="light" {% if current_theme=='light' %}selected{% endif %}>Light Mode</option>
                <option value="dark" {% if current_theme=='dark' %}selected{% endif %}>Dark Mode</option>
                <option value="midnight-tokyo" {% if current_theme=='midnight-tokyo' %}selected{% endif %}>Midnight
                    Tokyo (Neon)</option>
                <option value="abyss" {% if current_theme=='abyss' %}selected{% endif %}>Abyss (Ocean)</option>
            </select>
        </div>

        <div id="theme-preview" class="text-sm text-text-tertiary mb-4">
            {% if current_theme == 'system' %}
            ‚ÑπÔ∏è Theme will follow your browser/OS dark mode setting
            {% elif current_theme == 'dark' %}
            üåô Dark mode will be forced on
            {% elif current_theme == 'light' %}
            ‚òÄÔ∏è Light mode will be forced on
            {% elif current_theme == 'midnight-tokyo' %}
            üåÉ Cyberpunk neon theme
            {% elif current_theme == 'abyss' %}
            üåä Deep ocean void theme
            {% endif %}
        </div>
        <div class="mb-4">
            <a href="/color-test"
                class="inline-flex items-center px-4 py-2 text-accent bg-transparent border border-accent hover:bg-accent/10 focus:ring-4 focus:ring-accent/30 rounded-lg font-medium transition-colors duration-200">
                <i class="fas fa-palette mr-2"></i>
                üé® Test & Customize Theme Colors
            </a>
            <p class="text-xs text-text-secondary mt-2">Open the color testing tool to preview and customize theme
                colors with live examples.</p>
        </div>
        <div id="theme-success"
            class="hidden bg-theme-success-bg text-theme-success-text border border-theme-success-text rounded-lg px-4 py-3 mt-2">
            ‚úÖ Theme saved successfully!</div>
        <div id="theme-error"
            class="hidden bg-theme-error-bg text-theme-error-text border border-theme-error-text rounded-lg px-4 py-3 mt-2">
            ‚ùå Failed to save theme. Please try again.
        </div>
    </div>

    <!-- Security Settings -->
    <div
        class="bg-dashboard-surface rounded-lg shadow-lg p-6 mb-6 hover:-translate-y-0.5 transition-transform duration-200">
        <h2 class="text-2xl font-bold text-text-primary mb-4">üîí Security</h2>
        <p class="text-text-secondary mb-4">Manage your account security settings.</p>

        <form id="change-password-form" class="mb-4">
            <div class="mb-4">
                <label for="new-password" class="block text-sm font-medium text-text-secondary mb-2">
                    New Password <span class="text-theme-error-text">*</span>
                </label>
                <input type="password" id="new-password" required minlength="6" autocomplete="new-password" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢"
                    class="bg-dashboard-surface-alt border border-border text-text-primary text-sm rounded-lg focus:ring-accent focus:border-accent block w-full p-2.5">
            </div>
            <div class="mb-4">
                <label for="confirm-password" class="block text-sm font-medium text-text-secondary mb-2">
                    Confirm New Password <span class="text-theme-error-text">*</span>
                </label>
                <input type="password" id="confirm-password" required minlength="6" autocomplete="new-password" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢"
                    class="bg-dashboard-surface-alt border border-border text-text-primary text-sm rounded-lg focus:ring-accent focus:border-accent block w-full p-2.5">
            </div>
            <button type="submit" id="change-password-btn"
                class="px-4 py-2 text-accent bg-transparent border border-accent hover:bg-accent/10 focus:ring-4 focus:ring-accent/30 rounded-lg font-medium transition-colors duration-200">
                Update Password
            </button>
        </form>

        <div id="password-success"
            class="hidden bg-theme-success-bg text-theme-success-text border border-theme-success-text rounded-lg px-4 py-3 mt-2">
            ‚úÖ Password updated successfully!</div>
        <div id="password-error"
            class="hidden bg-theme-error-bg text-theme-error-text border border-theme-error-text rounded-lg px-4 py-3 mt-2">
            ‚ùå Failed to update password.</div>
    </div>
</div>
{% endblock %}

{% block extra_scripts %}
<!-- Settings Configuration -->
<script id="settings-config" type="application/json">
{
    "currentTimezone": "{{ current_timezone }}",
    "currentCurrency": "{{ current_currency }}",
    "currentTheme": "{{ current_theme }}"
}
</script>

<script type="module" src="/assets/js/settings.js" data-cfasync="false"></script>
{% endblock %}