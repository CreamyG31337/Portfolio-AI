{% extends "base.html" %}

{% block title %}Portfolio Performance Dashboard{% endblock %}

{% block page_title %}ðŸ“ˆ Portfolio Performance Dashboard{% endblock %}
{% block page_subtitle %}Real-time trading bot performance tracking{% endblock %}

{% block header_extra %}
<div class="hidden md:flex items-center space-x-4">
    <div>
        <label for="fund-select" class="text-sm text-blue-100 block">Select Fund</label>
        <select id="fund-select" class="border rounded px-3 py-2">
            <option value="">Select Fund</option>
        </select>
    </div>
    <div class="text-right">
        <div class="text-sm text-blue-100">Last Updated</div>
        <div id="last-updated" class="font-mono text-lg">Loading...</div>
    </div>
</div>
{% endblock %}

{% block extra_head %}
<script src="https://cdn.jsdelivr.net/npm/plotly.js@2.27.0/dist/plotly.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
{% endblock %}

{% block content %}
<!-- Performance Metrics Cards -->
<div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
    <div class="bg-dashboard-surface rounded-lg shadow-lg p-6 hover:-translate-y-0.5 transition-transform duration-200">
        <div class="flex items-center">
            <div class="p-3 rounded-full bg-theme-info-bg text-theme-info-text">
                <i class="fas fa-dollar-sign text-2xl"></i>
            </div>
            <div class="ml-4">
                <p class="text-sm font-medium text-text-secondary">Total Value</p>
                <p class="text-2xl font-bold text-text-primary" id="total-value">$0.00</p>
            </div>
        </div>
    </div>

    <div class="bg-dashboard-surface rounded-lg shadow-lg p-6 hover:-translate-y-0.5 transition-transform duration-200">
        <div class="flex items-center">
            <div class="p-3 rounded-full bg-theme-success-bg text-theme-success-text">
                <i class="fas fa-chart-line text-2xl"></i>
            </div>
            <div class="ml-4">
                <p class="text-sm font-medium text-text-secondary">Performance</p>
                <p class="text-2xl font-bold text-text-primary" id="performance-pct">0.00%</p>
            </div>
        </div>
    </div>

    <div class="bg-dashboard-surface rounded-lg shadow-lg p-6 hover:-translate-y-0.5 transition-transform duration-200">
        <div class="flex items-center">
            <div class="p-3 rounded-full bg-purple-100 text-purple-600">
                <i class="fas fa-coins text-2xl"></i>
            </div>
            <div class="ml-4">
                <p class="text-sm font-medium text-text-secondary">Unrealized P&L</p>
                <p class="text-2xl font-bold text-text-primary" id="unrealized-pnl">$0.00</p>
            </div>
        </div>
    </div>

    <div class="bg-dashboard-surface rounded-lg shadow-lg p-6 hover:-translate-y-0.5 transition-transform duration-200">
        <div class="flex items-center">
            <div class="p-3 rounded-full bg-theme-warning-bg text-theme-warning-text">
                <i class="fas fa-exchange-alt text-2xl"></i>
            </div>
            <div class="ml-4">
                <p class="text-sm font-medium text-text-secondary">Total Trades</p>
                <p class="text-2xl font-bold text-text-primary" id="total-trades">0</p>
            </div>
        </div>
    </div>
</div>

<!-- Performance Chart -->
<div class="bg-dashboard-surface rounded-lg shadow-lg p-6 mb-8">
    <h2 class="text-2xl font-bold text-text-primary mb-4">ðŸ“Š Performance Over Time</h2>
    <div class="mb-2 text-sm text-text-tertiary md:hidden">
        ðŸ’¡ Tip: Rotate your device for better viewing
    </div>
    <div id="performance-chart" class="h-[500px] overflow-x-auto"></div>
</div>

<!-- Current Positions and Recent Trades -->
<div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
    <!-- Current Positions -->
    <div class="bg-dashboard-surface rounded-lg shadow-lg p-6">
        <h2 class="text-2xl font-bold text-text-primary mb-4">ðŸ’¼ Current Positions</h2>
        <div id="positions-container">
            <div class="text-center text-text-tertiary py-8">
                <i class="fas fa-spinner fa-spin text-2xl mb-2"></i>
                <p>Loading positions...</p>
            </div>
        </div>
    </div>

    <!-- Recent Trades -->
    <div class="bg-dashboard-surface rounded-lg shadow-lg p-6">
        <h2 class="text-2xl font-bold text-text-primary mb-4">ðŸ“‹ Recent Trades</h2>
        <div id="trades-container">
            <div class="text-center text-text-tertiary py-8">
                <i class="fas fa-spinner fa-spin text-2xl mb-2"></i>
                <p>Loading trades...</p>
            </div>
        </div>
    </div>
</div>

<!-- Cash Balances -->
<div class="bg-dashboard-surface rounded-lg shadow-lg p-6 mt-8">
    <h2 class="text-2xl font-bold text-text-primary mb-4">ðŸ’° Cash Balances</h2>
    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
        <div class="bg-theme-info-bg rounded-lg p-4">
            <div class="flex items-center justify-between">
                <span class="text-lg font-medium text-theme-info-text">CAD Balance</span>
                <span class="text-2xl font-bold text-theme-info-text" id="cad-balance">$0.00</span>
            </div>
        </div>
        <div class="bg-theme-success-bg rounded-lg p-4">
            <div class="flex items-center justify-between">
                <span class="text-lg font-medium text-theme-success-text">USD Balance</span>
                <span class="text-2xl font-bold text-theme-success-text" id="usd-balance">$0.00</span>
            </div>
        </div>
    </div>
</div>

<!-- Fund Contributors/Holders -->
<div class="bg-dashboard-surface rounded-lg shadow-lg p-6 mt-8">
    <h2 class="text-2xl font-bold text-text-primary mb-4">ðŸ‘¥ Fund Contributors</h2>
    <div id="contributors-container">
        <div class="text-center text-text-tertiary py-8">
            <i class="fas fa-spinner fa-spin text-2xl mb-2"></i>
            <p>Loading contributors...</p>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_scripts %}
<script type="module" src="/assets/js/dashboard.js"></script>
{% endblock %}