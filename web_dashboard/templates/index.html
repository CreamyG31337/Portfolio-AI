{% extends "base.html" %}

{% block title %}Portfolio Performance Dashboard{% endblock %}

{% block page_title %}ðŸ“ˆ Portfolio Performance Dashboard{% endblock %}
{% block page_subtitle %}Real-time trading bot performance tracking{% endblock %}

{% block header_extra %}
<div class="hidden md:flex items-center space-x-4">
    <div>
        <label for="fund-select" class="text-sm text-blue-100 block">Select Fund</label>
        <select id="fund-select"
            class="bg-white text-gray-900 border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
            <option value="">Select Fund</option>
        </select>
    </div>
    <div class="text-right">
        <div class="text-sm text-blue-100">Last Updated</div>
        <div id="last-updated" class="font-mono text-lg">Loading...</div>
    </div>
</div>
{% endblock %}

{% block extra_head %}
<script src="https://cdn.plot.ly/plotly-2.27.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<style>
    .card-hover:hover {
        transform: translateY(-2px);
        transition: transform 0.2s ease-in-out;
    }

    .metric-card {
        background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
    }

    .performance-positive {
        color: #10b981;
    }

    .performance-negative {
        color: #ef4444;
    }
</style>
{% endblock %}

{% block content %}
<!-- Performance Metrics Cards -->
<div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
    <div class="bg-white rounded-lg shadow-lg p-6 card-hover">
        <div class="flex items-center">
            <div class="p-3 rounded-full bg-blue-100 text-blue-600">
                <i class="fas fa-dollar-sign text-2xl"></i>
            </div>
            <div class="ml-4">
                <p class="text-sm font-medium text-gray-600">Total Value</p>
                <p class="text-2xl font-bold text-gray-900" id="total-value">$0.00</p>
            </div>
        </div>
    </div>

    <div class="bg-white rounded-lg shadow-lg p-6 card-hover">
        <div class="flex items-center">
            <div class="p-3 rounded-full bg-green-100 text-green-600">
                <i class="fas fa-chart-line text-2xl"></i>
            </div>
            <div class="ml-4">
                <p class="text-sm font-medium text-gray-600">Performance</p>
                <p class="text-2xl font-bold" id="performance-pct">0.00%</p>
            </div>
        </div>
    </div>

    <div class="bg-white rounded-lg shadow-lg p-6 card-hover">
        <div class="flex items-center">
            <div class="p-3 rounded-full bg-purple-100 text-purple-600">
                <i class="fas fa-coins text-2xl"></i>
            </div>
            <div class="ml-4">
                <p class="text-sm font-medium text-gray-600">Unrealized P&L</p>
                <p class="text-2xl font-bold" id="unrealized-pnl">$0.00</p>
            </div>
        </div>
    </div>

    <div class="bg-white rounded-lg shadow-lg p-6 card-hover">
        <div class="flex items-center">
            <div class="p-3 rounded-full bg-orange-100 text-orange-600">
                <i class="fas fa-exchange-alt text-2xl"></i>
            </div>
            <div class="ml-4">
                <p class="text-sm font-medium text-gray-600">Total Trades</p>
                <p class="text-2xl font-bold text-gray-900" id="total-trades">0</p>
            </div>
        </div>
    </div>
</div>

<!-- Performance Chart -->
<div class="bg-white rounded-lg shadow-lg p-6 mb-8">
    <h2 class="text-2xl font-bold text-gray-900 mb-4">ðŸ“Š Performance Over Time</h2>
    <div class="mb-2 text-sm text-gray-500 md:hidden">
        ðŸ’¡ Tip: Rotate your device for better viewing
    </div>
    <div id="performance-chart" style="height: 500px;" class="overflow-x-auto"></div>
</div>

<!-- Current Positions and Recent Trades -->
<div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
    <!-- Current Positions -->
    <div class="bg-white rounded-lg shadow-lg p-6">
        <h2 class="text-2xl font-bold text-gray-900 mb-4">ðŸ’¼ Current Positions</h2>
        <div id="positions-container">
            <div class="text-center text-gray-500 py-8">
                <i class="fas fa-spinner fa-spin text-2xl mb-2"></i>
                <p>Loading positions...</p>
            </div>
        </div>
    </div>

    <!-- Recent Trades -->
    <div class="bg-white rounded-lg shadow-lg p-6">
        <h2 class="text-2xl font-bold text-gray-900 mb-4">ðŸ“‹ Recent Trades</h2>
        <div id="trades-container">
            <div class="text-center text-gray-500 py-8">
                <i class="fas fa-spinner fa-spin text-2xl mb-2"></i>
                <p>Loading trades...</p>
            </div>
        </div>
    </div>
</div>

<!-- Cash Balances -->
<div class="bg-white rounded-lg shadow-lg p-6 mt-8">
    <h2 class="text-2xl font-bold text-gray-900 mb-4">ðŸ’° Cash Balances</h2>
    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
        <div class="bg-blue-50 rounded-lg p-4">
            <div class="flex items-center justify-between">
                <span class="text-lg font-medium text-gray-700">CAD Balance</span>
                <span class="text-2xl font-bold text-blue-600" id="cad-balance">$0.00</span>
            </div>
        </div>
        <div class="bg-green-50 rounded-lg p-4">
            <div class="flex items-center justify-between">
                <span class="text-lg font-medium text-gray-700">USD Balance</span>
                <span class="text-2xl font-bold text-green-600" id="usd-balance">$0.00</span>
            </div>
        </div>
    </div>
</div>

<!-- Fund Contributors/Holders -->
<div class="bg-white rounded-lg shadow-lg p-6 mt-8">
    <h2 class="text-2xl font-bold text-gray-900 mb-4">ðŸ‘¥ Fund Contributors</h2>
    <div id="contributors-container">
        <div class="text-center text-gray-500 py-8">
            <i class="fas fa-spinner fa-spin text-2xl mb-2"></i>
            <p>Loading contributors...</p>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_scripts %}
<script type="module" src="/assets/js/dashboard.js"></script>
{% endblock %}